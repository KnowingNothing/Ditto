# shared_load+store,shared_throughput,l2_hit_rate,l2_load+store,l2_throughput,dram_read+write,dram_throughput
# ncu --metrics smsp__inst_executed_op_shared_ld.sum,smsp__inst_executed_op_shared_st.sum,l1tex__data_pipe_lsu_wavefronts_mem_shared_op_ld.sum.per_second,lts__t_request_hit_rate.avg,lts__t_bytes_equiv_l1sectormiss_pipe_lsu_mem_global_op_ld.sum,+lts__t_bytes_equiv_l1sectormiss_pipe_lsu_mem_global_op_st.sum,lts__t_sectors_op_read.sum.per_second+lts__t_sectors_op_write.sum.per_second,dram__bytes_read.sum+dram__bytes_write.sum,dram__bytes_read.sum.per_second,+dram__bytes_write.sum.per_second --print-summary per-gpu --csv python torch_bmm_softmax_bmm_cuda.py --dtype float16 --only_once |& tee torch_bmm_softmax_bmm_metrics.csv
ncu --section MemoryWorkloadAnalysis python torch_bmm_softmax_bmm_cuda.py --dtype float16 --only_once |& tee ncu_memory_analysis_torch_bmm_softmax_bmm.txt
ncu --section MemoryWorkloadAnalysis python chimera_bmm_softmax_bmm_cuda.py --in_dtype float16 --acc_dtype float32 --sm 80 --only_once |& tee ncu_memory_analysis_chimera_bmm_softmax_bmm.txt