from ...hw_path import *
from .cuda_isa import *
from .cuda_pattern import *


scalar_paths = [
    compute_path(
        cuda_add_fp32_fp32_fp32,
        scalar_patterns["scalar_fp32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_add_fp16_fp16_fp32,
        scalar_patterns["scalar_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_add_fp16_fp16_fp32,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_add_fp16_fp16_fp16,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_sub_fp32_fp32_fp32,
        scalar_patterns["scalar_fp32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_sub_fp16_fp16_fp32,
        scalar_patterns["scalar_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_sub_fp16_fp16_fp32,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_sub_fp16_fp16_fp16,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mul_fp32_fp32_fp32,
        scalar_patterns["scalar_fp32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mul_fp16_fp16_fp32,
        scalar_patterns["scalar_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_mul_fp16_fp16_fp32,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_mul_fp16_fp16_fp16,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_div_fp32_fp32_fp32,
        scalar_patterns["scalar_fp32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_div_fp16_fp16_fp32,
        scalar_patterns["scalar_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_div_fp16_fp16_fp32,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_div_fp16_fp16_fp16,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mod_fp32_fp32_fp32,
        scalar_patterns["scalar_fp32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mod_fp16_fp16_fp32,
        scalar_patterns["scalar_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_mod_fp16_fp16_fp32,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_mod_fp16_fp16_fp16,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_fma_fp32_fp32_fp32,
        scalar_patterns["scalar_fp32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_fma_fp16_fp16_fp32,
        scalar_patterns["scalar_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_fma_fp16_fp16_fp32,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_fma_fp16_fp16_fp16,
        scalar_patterns["scalar_fp16"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_add_int32_int32_int32,
        scalar_patterns["scalar_int32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_add_int8_int8_int32,
        scalar_patterns["scalar_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_add_int8_int8_int32,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_add_int8_int8_int8,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_sub_int32_int32_int32,
        scalar_patterns["scalar_int32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_sub_int8_int8_int32,
        scalar_patterns["scalar_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_sub_int8_int8_int32,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_sub_int8_int8_int8,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mul_int32_int32_int32,
        scalar_patterns["scalar_int32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mul_int8_int8_int32,
        scalar_patterns["scalar_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_mul_int8_int8_int32,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_mul_int8_int8_int8,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_div_int32_int32_int32,
        scalar_patterns["scalar_int32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_div_int8_int8_int32,
        scalar_patterns["scalar_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_div_int8_int8_int32,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_div_int8_int8_int8,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mod_int32_int32_int32,
        scalar_patterns["scalar_int32"],
        visa.direct(),
        visa.direct(),
    ),
    compute_path(
        cuda_mod_int8_int8_int32,
        scalar_patterns["scalar_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_mod_int8_int8_int32,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_mod_int8_int8_int8,
        scalar_patterns["scalar_int8"],
        visa.direct(),
        visa.direct(),
    ),
]


wmma_sm70_paths = [
    # fp16 fp16 fp32
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_8x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x32_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_32x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x8_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_8x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x32_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_32x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x8_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_8x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x32_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_32x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x8_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_row_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_8x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x32_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_a_32x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["matrix_b_16x8_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_col_major_fp16_fp16_fp32,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    # fp16 fp16 fp16
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_8x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x32_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_32x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x8_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_8x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x32_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_32x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x8_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x16_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_8x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x32_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_32x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x8_row_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_row_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_16x16_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_8x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x32_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_8x32_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_a_32x16_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["matrix_b_16x8_col_major_fp16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_col_major_col_major_fp16_fp16_fp16,
        wmma_sm70_patterns["accumulator_32x8_row_major_fp16"],
        visa.none(),
        visa.direct(),
    ),
]


wmma_sm75_paths = [
    # int8 int8 int32
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["matrix_a_16x16_row_major_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["matrix_b_16x16_row_major_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["accumulator_16x16_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["matrix_a_8x16_row_major_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["matrix_b_16x32_row_major_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["accumulator_8x32_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["matrix_a_32x16_row_major_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["matrix_b_16x8_row_major_int8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_int8_int8_int32,
        wmma_sm75_patterns["accumulator_32x8_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    # uint8 uint8 int32
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["matrix_a_16x16_row_major_uint8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["matrix_b_16x16_row_major_uint8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["accumulator_16x16_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["matrix_a_8x16_row_major_uint8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["matrix_b_16x32_row_major_uint8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["accumulator_8x32_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["matrix_a_32x16_row_major_uint8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["matrix_b_16x8_row_major_uint8"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_uint8_uint8_int32,
        wmma_sm75_patterns["accumulator_32x8_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    # int4 int4 int32
    compute_path(
        cuda_wmma_m8_n8_k32_row_major_row_major_int4_int4_int32,
        wmma_sm75_patterns["matrix_a_8x32_row_major_int4"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k32_row_major_row_major_int4_int4_int32,
        wmma_sm75_patterns["matrix_b_32x8_row_major_int4"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k32_row_major_row_major_int4_int4_int32,
        wmma_sm75_patterns["accumulator_8x8_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    # uint4 uint4 int32
    compute_path(
        cuda_wmma_m8_n8_k32_row_major_row_major_uint4_uint4_int32,
        wmma_sm75_patterns["matrix_a_8x32_row_major_uint4"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k32_row_major_row_major_uint4_uint4_int32,
        wmma_sm75_patterns["matrix_b_32x8_row_major_uint4"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k32_row_major_row_major_uint4_uint4_int32,
        wmma_sm75_patterns["accumulator_8x8_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
    # bin bin int32
    compute_path(
        cuda_wmma_m8_n8_k128_row_major_row_major_bin_bin_int32,
        wmma_sm75_patterns["matrix_a_8x128_row_major_bin"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k128_row_major_row_major_bin_bin_int32,
        wmma_sm75_patterns["matrix_b_128x8_row_major_bin"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k128_row_major_row_major_bin_bin_int32,
        wmma_sm75_patterns["accumulator_8x8_row_major_int32"],
        visa.none(),
        visa.direct(),
    ),
]


wmma_sm80_paths = [
    # bf16 bf16 fp32
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["matrix_a_16x16_row_major_bf16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["matrix_b_16x16_row_major_bf16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["accumulator_16x16_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["matrix_a_8x16_row_major_bf16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["matrix_b_16x32_row_major_bf16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n32_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["accumulator_8x32_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["matrix_a_32x16_row_major_bf16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["matrix_b_16x8_row_major_bf16"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m32_n8_k16_row_major_row_major_bf16_bf16_fp32,
        wmma_sm80_patterns["accumulator_32x8_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    # tf32 tf32 fp32
    compute_path(
        cuda_wmma_m16_n16_k8_row_major_row_major_tf32_tf32_fp32,
        wmma_sm80_patterns["matrix_a_16x8_row_major_tf32"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k8_row_major_row_major_tf32_tf32_fp32,
        wmma_sm80_patterns["matrix_b_8x16_row_major_tf32"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m16_n16_k8_row_major_row_major_tf32_tf32_fp32,
        wmma_sm80_patterns["accumulator_16x16_row_major_fp32"],
        visa.none(),
        visa.direct(),
    ),
    # fp64 fp64 fp64
    compute_path(
        cuda_wmma_m8_n8_k4_row_major_row_major_fp64_fp64_fp64,
        wmma_sm80_patterns["matrix_a_8x4_row_major_fp64"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k4_row_major_row_major_fp64_fp64_fp64,
        wmma_sm80_patterns["matrix_b_4x8_row_major_fp64"],
        visa.direct(),
        visa.none(),
    ),
    compute_path(
        cuda_wmma_m8_n8_k4_row_major_row_major_fp64_fp64_fp64,
        wmma_sm80_patterns["accumulator_8x8_row_major_fp64"],
        visa.none(),
        visa.direct(),
    ),
]
